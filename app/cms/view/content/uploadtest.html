{extend name="../../admin/view/main"}
{block name="content"}
<div class="layui-tab layui-tab-card think-bg-white">
    <form class="layui-form layui-card" action="{:request()->url()}" data-auto="true" method="post" autocomplete="off">
        <div class="layui-card-body">
            <div class="layui-form-item">
                <label class="layui-form-label">图片上传</label>
                <div class="layui-input-block">
                    <button type="button" data-modal="{:url('module/attachment/fileManager')}" class="layui-btn" style="float: left; margin-right: 15px;">图片选择</button>
                    <input type="hidden" name="thumb" id="thumb" value="{$vo.thumb|default=''}">
                    <script>$('[name=thumb]').uploadOneImage()</script>
                </div>

            </div>
            <div class="hr-line-dashed"></div>
            {notempty name='vo.id'}<input type='hidden' value='{$vo.id}' name='id'>{/notempty}
            <div class="layui-form-item text-center">
                <button class="layui-btn layui-btn-normal" lay-submit lay-filter="saveData">保存数据</button>
                <button class="layui-btn layui-btn-danger" type='button' data-confirm="确定要取消编辑吗？" data-close>取消编辑</button>
            </div>
        </div>
    </form>
</div>
{/block}
{block name='style'}
<link rel="stylesheet" href="__ROOT__/static/plugs/layui/mods/cascader.css">
{/block}
{block name='script'}
<script>
    layui.form.render();
    layui.config({
        base: "__ROOT__/static/plugs/layui/mods/"
    });
    layui.use(['jquery'], function () {
        var layer = layui.layer,
            $ = layui.jquery;

        //弹层选择后的回调
        window.callbackFun = function(res){
            var obj = $('#thumb');
            obj.val(res.thumb);
            obj.next('a.uploadimage').css({'backgroundImage':'url('+res.thumb+')'});
        }
    });
</script>
{/block}