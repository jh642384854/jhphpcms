{extend name="../../admin/view/main"}

{block name="button"}
<!--{if auth("add")}-->
<button data-open='{:url("add")}' data-title="添加文章" class='layui-btn layui-btn-sm layui-btn-primary'>添加文章</button>
<!--{/if}-->
{/block}

{block name="content"}
<div class="layui-tab">
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md2">
            <div class="category_tree think-bg-white">
                <ul id="categoryTree" class="ztree"></ul>
            </div>
        </div>
        <div class="layui-col-md10">
            <div class="article_list think-bg-white">
                <ul class="layui-tab-title">
                    <li class="layui-this">文章模型</li>
                    <li>图片模型</li>
                    <li>视频模型</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{/block}

{block name='style'}
<link href="__ROOT__/static/plugs/ztree/zTreeStyle/zTreeStyle.css" rel="stylesheet">
<script src="__ROOT__/static/plugs/ztree/ztree.all.min.js"></script>
<style>
.category_tree,.article_list{min-height: 650px;}
</style>
{/block}

{block name='script'}
<script>
    var zNodes = [{
        title: '一级1'
        ,id: 1
        ,field: 'name1'
        ,checked: true
        ,spread: true
        ,children: [{
            title: '二级1-1 可允许跳转'
            ,id: 3
            ,field: 'name11'
            ,href: 'https://www.layui.com/'
            ,children: [{
                title: '三级1-1-3'
                ,id: 23
                ,field: ''
                ,children: [{
                    title: '四级1-1-3-1'
                    ,id: 24
                    ,field: ''
                    ,children: [{
                        title: '五级1-1-3-1-1'
                        ,id: 30
                        ,field: ''
                    },{
                        title: '五级1-1-3-1-2'
                        ,id: 31
                        ,field: ''
                    }]
                }]
            },{
                title: '三级1-1-1'
                ,id: 7
                ,field: ''
                ,children: [{
                    title: '四级1-1-1-1 可允许跳转'
                    ,id: 15
                    ,field: ''
                    ,href: 'https://www.layui.com/doc/'
                }]
            },{
                title: '三级1-1-2'
                ,id: 8
                ,field: ''
                ,children: [{
                    title: '四级1-1-2-1'
                    ,id: 32
                    ,field: ''
                }]
            }]
        },{
            title: '二级1-2'
            ,id: 4
            ,spread: true
            ,children: [{
                title: '三级1-2-1'
                ,id: 9
                ,field: ''
                ,disabled: true
            },{
                title: '三级1-2-2'
                ,id: 10
                ,field: ''
            }]
        },{
            title: '二级1-3'
            ,id: 20
            ,field: ''
            ,children: [{
                title: '三级1-3-1'
                ,id: 21
                ,field: ''
            },{
                title: '三级1-3-2'
                ,id: 22
                ,field: ''
            }]
        }]
    },{
        title: '一级2'
        ,id: 2
        ,field: ''
        ,spread: true
        ,children: [{
            title: '二级2-1'
            ,id: 5
            ,field: ''
            ,spread: true
            ,children: [{
                title: '三级2-1-1'
                ,id: 11
                ,field: ''
            },{
                title: '三级2-1-2'
                ,id: 12
                ,field: ''
            }]
        },{
            title: '二级2-2'
            ,id: 6
            ,field: ''
            ,children: [{
                title: '三级2-2-1'
                ,id: 13
                ,field: ''
            },{
                title: '三级2-2-2'
                ,id: 14
                ,field: ''
                ,disabled: true
            }]
        }]
    },{
        title: '一级3'
        ,id: 16
        ,field: ''
        ,children: [{
            title: '二级3-1'
            ,id: 17
            ,field: ''
            ,fixed: true
            ,children: [{
                title: '三级3-1-1'
                ,id: 18
                ,field: ''
            },{
                title: '三级3-1-2'
                ,id: 19
                ,field: ''
            }]
        },{
            title: '二级3-2'
            ,id: 27
            ,field: ''
            ,children: [{
                title: '三级3-2-1'
                ,id: 28
                ,field: ''
            },{
                title: '三级3-2-2'
                ,id: 29
                ,field: ''
            }]
        }]
    }];
    layui.use(['tree', 'util'], function(){
        var tree = layui.tree
            ,layer = layui.layer
            ;
        tree.render({
            elem: '#categoryTree' //默认是点击节点可进行收缩
            ,data: zNodes
        });
    });
    window.CategoryAction = new function () {
        this.data = {};
        this.ztree = null;
        this.setting = {
            data:{
                simpleData: {
                    enable: true,
                    pIdKey : 'parent_id',
                }
            },
            view: {showLine: true, showIcon: true, dblClickExpand: false},
            callback: {
                /*beforeClick: function (id, node) {
                    node.children.length < 1 ? RoleAction.ztree.checkNode(node, !node.checked, null, true) : RoleAction.ztree.expandNode(node);
                    return false;
                }*/
            }
        };
        this.showTree = function(that, index){
            console.log('showTree');
            this.ztree = $.fn.zTree.init($("#categoryTree"), this.setting, zNodes);
        };
        this.getData = function (that, index) {
            //that.showTree();

        };
        //this.getData(this);
    }
</script>
{/block}