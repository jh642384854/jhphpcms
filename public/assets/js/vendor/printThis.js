(function(a){function c(f,g){if(!g){return}f.append(g.jquery?g.clone():g)}function b(f,h,i){var g=h.clone(i.formValues);if(i.formValues){d(h,g,"select, textarea")}if(i.removeScripts){g.find("script").remove()}if(i.printContainer){g.appendTo(f)}else{g.each(function(){a(this).children().appendTo(f)})}}function d(i,g,h){var f=i.find(h);g.find(h).each(function(j,k){a(k).val(f.eq(j).val())})}var e;a.fn.printThis=function(j){e=a.extend({},a.fn.printThis.defaults,j);var f=this instanceof jQuery?this:a(this);var l="printThis-"+(new Date()).getTime();if(window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)){var i='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";</script></head><body></body>")';var k=document.createElement("iframe");k.name="printIframe";k.id=l;k.className="MSIE";document.body.appendChild(k);k.src=i}else{var g=a("<iframe id='"+l+"' name='printIframe' />");g.appendTo("body")}var h=a("#"+l);if(!e.debug){h.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"})}if(typeof e.beforePrint==="function"){e.beforePrint()}setTimeout(function(){function v(x,z){var A,y;A=x.get(0);A=A.contentWindow||A.contentDocument||A;y=A.document||A.contentDocument||A;y.open();y.write(z);y.close()}if(e.doctypeString){v(h,e.doctypeString)}var o=h.contents(),p=o.find("head"),n=o.find("body"),m=a("base"),r;if(e.base===true&&m.length>0){r=m.attr("href")}else{if(typeof e.base==="string"){r=e.base}else{r=document.location.protocol+"//"+document.location.host}}p.append('<base href="'+r+'">');if(e.importCSS){a("link[rel=stylesheet]").each(function(){var x=a(this).attr("href");if(x){var y=a(this).attr("media")||"all";p.append("<link type='text/css' rel='stylesheet' href='"+x+"' media='"+y+"'>")}})}if(e.importStyle){a("style").each(function(){p.append(this.outerHTML)})}if(e.pageTitle){p.append("<title>"+e.pageTitle+"</title>")}if(e.loadCSS){if(a.isArray(e.loadCSS)){jQuery.each(e.loadCSS,function(x,y){p.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")})}else{p.append("<link type='text/css' rel='stylesheet' href='"+e.loadCSS+"'>")}}var t=a("html")[0];o.find("html").prop("style",t.style.cssText);var w=e.copyTagClasses;if(w){w=w===true?"bh":w;if(w.indexOf("b")!==-1){n.addClass(a("body")[0].className)}if(w.indexOf("h")!==-1){o.find("html").addClass(t.className)}}c(n,e.header);if(e.canvas){var s=0;f.find("canvas").addBack("canvas").each(function(){a(this).attr("data-printthis",s++)})}b(n,f,e);if(e.canvas){n.find("canvas").each(function(){var y=a(this).data("printthis"),x=a('[data-printthis="'+y+'"]');this.getContext("2d").drawImage(x[0],0,0);if(a.isFunction(a.fn.removeAttr)){x.removeAttr("data-printthis")}else{a.each(x,function(A,z){z.removeAttribute("data-printthis")})}})}if(e.removeInline){var u=e.removeInlineSelector||"*";if(a.isFunction(a.removeAttr)){n.find(u).removeAttr("style")}else{n.find(u).attr("style","")}}c(n,e.footer);function q(x,y){var z=x.get(0);z=z.contentWindow||z.contentDocument||z;if(typeof y==="function"){if("matchMedia" in z){z.matchMedia("print").addListener(function(A){if(A.matches){y()}})}else{z.onbeforeprint=y}}}q(h,e.beforePrintEvent);setTimeout(function(){if(h.hasClass("MSIE")){window.frames.printIframe.focus();p.append("<script>  window.print(); </script>")}else{if(document.queryCommandSupported("print")){h[0].contentWindow.document.execCommand("print",false,null)}else{h[0].contentWindow.focus();h[0].contentWindow.print()}}if(!e.debug){setTimeout(function(){h.remove()},1000)}if(typeof e.afterPrint==="function"){e.afterPrint()}},e.printDelay)},333)};a.fn.printThis.defaults={debug:false,importCSS:true,importStyle:false,printContainer:true,loadCSS:"",pageTitle:"",removeInline:false,removeInlineSelector:"*",printDelay:333,header:null,footer:null,base:false,formValues:true,canvas:false,doctypeString:"<!DOCTYPE html>",removeScripts:false,copyTagClasses:false,beforePrintEvent:null,beforePrint:null,afterPrint:null}})(jQuery);